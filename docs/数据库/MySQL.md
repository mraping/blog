### 开发使用记录

1. mysql 设置了默认值了为什么还是会报column cannot be null --> 去掉非空约束
2. SELECT_COLUMNS  用途，修改了数据库字段后避免 SELECT * 与model对应不到的问题

### 线上故障记录及分析

#### 故障描述

直接在线上添加字段，执行耗时较长，在主库添加字段后同步到从库时也较慢，同时导致线上服务不可用

#### 前提说明

- 线上表的数据量：4581993
- 数据库版本：Mysql 5.6
- 表内数据不时有新增和更新

#### 故障分析

Mysql在5.6版本之前，线上大表新增字段是需要停机的，因为这时候mysql会锁表，任何写操作都会被阻塞。

不过如果能保证数据库只读就没问题。

直接先在主上操作，那么会导致主从延迟很大(在量比较大的情况下)。因为主从复制，从库的SQL线程是单线程，它接收到主库的BINLOG，要一条一条执行，一条SQL卡住了，后面的SQL就会排队等待，这时同步就延迟了

